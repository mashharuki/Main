# タスク完了時のチェックリスト

## 必須ステップ

### 1. コード品質チェック

#### フォーマット
```bash
pnpm format
```
- Biomeでプロジェクト全体をフォーマット
- タブインデント、ダブルクォートの統一
- Import文の自動整理

#### 型チェック
```bash
# 各パッケージで実行
cd pkgs/contract && pnpm build
cd pkgs/cli && pnpm typecheck
cd pkgs/frontend && pnpm build
```
- TypeScriptの型エラーがないことを確認
- `any`型の使用を避ける

#### リント
```bash
# 各パッケージで実行
cd pkgs/contract && pnpm lint
cd pkgs/cli && pnpm lint
cd pkgs/frontend && pnpm lint
```
- ESLintのルールに準拠
- 警告も可能な限り解消

### 2. テスト実行

#### Contract パッケージ
```bash
cd pkgs/contract
pnpm test
```
- すべてのテストがパス
- 新機能には必ずテストを追加

#### CLI パッケージ
```bash
cd pkgs/cli
pnpm test-api  # スタンドアロン環境でのテスト
```
- Docker環境でのテストが正常に動作
- 必要に応じてTestnet環境でもテスト

#### Frontend パッケージ
```bash
cd pkgs/frontend
pnpm build  # ビルドエラーがないことを確認
```

### 3. ビルド確認

#### すべてのパッケージでビルド成功を確認
```bash
cd pkgs/contract && pnpm build
cd pkgs/cli && pnpm build
cd pkgs/frontend && pnpm build
```

### 4. Git コミット

#### コミット前の確認
- [ ] 不要なファイルが含まれていないか
- [ ] `.env` などの機密情報が含まれていないか
- [ ] `console.log` などのデバッグコードが残っていないか

#### コミットメッセージ
```bash
git add .
git commit -m "feat: add patient data encryption"
```
- コンベンショナルコミット形式を使用
- 明確で説明的なメッセージ
- 必要に応じてボディとフッターを追加

## 推奨ステップ

### コードレビュー自己チェック

#### 可読性
- [ ] 変数名・関数名が意図を明確に表現しているか
- [ ] 複雑なロジックにコメントが付いているか
- [ ] DRY原則に従っているか

#### エラーハンドリング
- [ ] すべてのエラーケースを処理しているか
- [ ] エラーメッセージが明確か
- [ ] エラーの抑制（`@ts-ignore`など）を使用していないか

#### セキュリティ
- [ ] 外部入力を検証しているか
- [ ] 機密情報がハードコードされていないか
- [ ] 最小権限の原則に従っているか

#### パフォーマンス
- [ ] N+1問題が発生していないか
- [ ] 不要な再レンダリングが発生していないか
- [ ] 大きなデータセットの処理が最適化されているか

### ドキュメント更新

#### README更新
- [ ] 新機能の説明を追加
- [ ] セットアップ手順が最新か
- [ ] 使用例が正確か

#### コメント・JSDoc
- [ ] パブリックAPIにJSDocが付いているか
- [ ] 複雑なロジックに説明コメントがあるか

### 技術的負債の記録

#### TODOコメント
```typescript
// TODO: パフォーマンス最適化が必要
// FIXME: エッジケースの処理を追加
// HACK: 一時的な回避策、後で修正が必要
```

#### Issue作成
- 大きな技術的負債はGitHub Issueとして記録
- 優先度と期限を明記

## Compact コントラクト特有のチェック

### コンパイル確認
```bash
cd pkgs/contract
pnpm compact
```
- Compactコンパイラがエラーなく完了
- 生成されたTypeScriptファイルが正しい

### ZK証明の検証
- [ ] 公開状態（ledger）の定義が正しいか
- [ ] 状態遷移関数（circuit）が期待通りに動作するか
- [ ] Witness関数が適切に実装されているか

## 最終確認

### 動作確認
- [ ] ローカル環境で正常に動作するか
- [ ] 主要な機能が期待通りに動作するか
- [ ] エラーケースが適切に処理されるか

### ブランチ戦略
- [ ] main/masterブランチへの直接コミットを避ける
- [ ] フィーチャーブランチから作業
- [ ] プルリクエストを作成してレビューを依頼

## チェックリスト完了後

すべてのチェックが完了したら：

1. 変更をコミット
2. リモートにプッシュ
3. プルリクエストを作成（必要に応じて）
4. レビューを依頼
5. CI/CDパイプラインの結果を確認
