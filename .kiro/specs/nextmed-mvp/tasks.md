# NextMed MVP 実装タスクリスト（更新版）

## タスク概要

このタスクリストは、更新された設計書に基づき、Compact言語の制約を踏まえた実装可能なタスクを定義します。TDD（テスト駆動開発）の原則に従い、すべてのタスクで**Red → Green → Refactor**のサイクルを厳守します。

---

## - [ ] 1. プロジェクト初期セットアップ

### - [ ] 1.1 モノレポ構造の確認と調整
- 既存の`pkgs/contract`, `pkgs/cli`, `pkgs/frontend`ディレクトリの確認
- 必要に応じて`pkgs/backend`ディレクトリの追加
- ルートレベルの`package.json`と`pnpm-workspace.yaml`の確認
- _要件: 要件9_

### - [ ] 1.2 開発環境の確認
- Node.js 18 LTSのインストール確認
- pnpm 10.20.0のインストール確認
- Compact Compilerのインストールと`COMPACT_HOME`環境変数の確認
- Docker Desktopの起動確認
- _要件: 要件9_

### - [ ] 1.3 Lace Walletのセットアップ確認
- Lace Wallet Chrome拡張機能のインストール確認
- Testnet用ウォレットの作成確認
- Midnight Testnet FaucetからのtDUST取得確認
- _要件: 要件5_

### - [ ] 1.4 Proof Serverの起動確認
- Docker経由でProof Serverを起動
- Proof Serverの動作確認
- _要件: 要件9_

---

## - [ ] 2. スマートコントラクトの実装（TDD）

### - [ ] 2.1 Compactプロジェクトのセットアップ
- `pkgs/contract`ディレクトリの確認
- `package.json`の依存関係確認（`@midnight-ntwrk/compact-runtime`, `vitest`）
- `tsconfig.json`の設定確認
- Vitestテスト環境のセットアップ確認
- _要件: 要件9_

### - [ ] 2.2 Compactコントラクトの基本構造作成（TDD）

#### - [ ] 2.2.1 テストファイルの作成（Red）
- `pkgs/contract/src/test/nextmed.test.ts`を作成
- テストシミュレーター`pkgs/contract/src/test/nextmed-simulator.ts`のスケルトンを作成
- 最初のテストケース（患者登録の正常系）を記述
- テストを実行して失敗することを確認
- _要件: 要件1_

#### - [ ] 2.2.2 Compactファイルの作成（Green）
- `pkgs/contract/src/nextmed.compact`を作成
- 基本的なLedger宣言（`patientCount: Counter`のみ）
- 最小限の`registerPatient`回路を実装
- テストが通ることを確認
- _要件: 要件1_

#### - [ ] 2.2.3 リファクタリング（Refactor）
- コードの整理
- コメントの追加
- _要件: 要件1_

### - [ ] 2.3 患者データ登録機能の完全実装（TDD）

#### - [ ] 2.3.1 患者データ登録の全テストケースを追加（Red）
- 正常系: 有効なデータで患者登録が成功するテスト
- 正常系: 複数の患者を登録できるテスト
- 正常系: 境界値（0歳、150歳）で登録できるテスト
- 異常系: 年齢が範囲外（151歳）でエラーになるテスト
- 異常系: 性別が範囲外（3）でエラーになるテスト
- テストを実行して失敗することを確認
- _要件: 要件1_

#### - [ ] 2.3.2 完全な患者データ登録機能の実装（Green）
- `patientAges: Map<Bytes<32>, Uint<0..150>>`のLedger宣言
- `patientGenders: Map<Bytes<32>, Uint<0..2>>`のLedger宣言
- `patientConditions: Map<Bytes<32>, Bytes<32>>`のLedger宣言
- `witness getSecretKey(): Bytes<32>`の宣言
- `registerPatient`回路の完全実装
- すべてのテストが通ることを確認
- _要件: 要件1, 要件6_

#### - [ ] 2.3.3 リファクタリング（Refactor）
- ヘルパー関数の抽出（患者ID生成ロジック）
- コードの重複削除
- _要件: 要件1_

### - [ ] 2.4 同意管理機能の実装（TDD）

#### - [ ] 2.4.1 同意付与のテストケースを追加（Red）
- 正常系: 同意付与が成功するテスト
- 正常系: 同じ研究者に複数回同意を付与できるテスト（冪等性）
- 異常系: 存在しない患者IDで同意付与するとエラーになるテスト
- テストを実行して失敗することを確認
- _要件: 要件2_

#### - [ ] 2.4.2 同意付与機能の実装（Green）
- `consents: Map<Bytes<64>, Boolean>`のLedger宣言
- `consentTimestamps: Map<Bytes<64>, Uint<64>>`のLedger宣言
- `makeConsentKey`ヘルパー関数の実装
- `grantConsent`回路の実装
- すべてのテストが通ることを確認
- _要件: 要件2_

#### - [ ] 2.4.3 同意取り消しのテストケースを追加（Red）
- 正常系: 同意取り消しが成功するテスト
- 異常系: 同意が存在しない場合エラーになるテスト
- テストを実行して失敗することを確認
- _要件: 要件2_

#### - [ ] 2.4.4 同意取り消し機能の実装（Green）
- `revokeConsent`回路の実装
- すべてのテストが通ることを確認
- _要件: 要件2_

#### - [ ] 2.4.5 同意確認のテストケースを追加（Red）
- 正常系: 同意がない場合falseを返すテスト
- 正常系: 同意がある場合trueを返すテスト
- テストを実行して失敗することを確認
- _要件: 要件2_

#### - [ ] 2.4.6 同意確認機能の実装（Green）
- `checkConsent`回路の実装
- すべてのテストが通ることを確認
- _要件: 要件2_

#### - [ ] 2.4.7 リファクタリング（Refactor）
- 同意管理ロジックの最適化
- 複合キー生成ロジックの共通化
- _要件: 要件2_

### - [ ] 2.5 クエリ記録機能の実装（TDD）

#### - [ ] 2.5.1 クエリ記録のテストケースを追加（Red）
- 正常系: クエリ記録が成功するテスト
- 正常系: 複数のクエリを記録できるテスト
- テストを実行して失敗することを確認
- _要件: 要件3_

#### - [ ] 2.5.2 クエリ記録機能の実装（Green）
- `queryCount: Counter`のLedger宣言
- `recordQuery`回路の実装
- すべてのテストが通ることを確認
- _要件: 要件3_

#### - [ ] 2.5.3 リファクタリング（Refactor）
- クエリ記録ロジックの最適化
- _要件: 要件3_

### - [ ] 2.6 患者データ取得機能の実装（TDD）

#### - [ ] 2.6.1 患者データ取得のテストケースを追加（Red）
- 正常系: 患者データを正しく取得できるテスト
- 異常系: 存在しない患者IDでエラーになるテスト
- テストを実行して失敗することを確認
- _要件: 要件1_

#### - [ ] 2.6.2 患者データ取得機能の実装（Green）
- `getPatientData`回路の実装
- すべてのテストが通ることを確認
- _要件: 要件1_

#### - [ ] 2.6.3 リファクタリング（Refactor）
- データ取得ロジックの最適化
- _要件: 要件1_

### - [ ] 2.7 Witness関数の実装

#### - [ ] 2.7.1 TypeScript側のWitness実装
- `pkgs/contract/src/witnesses.ts`の作成
- `NextMedPrivateState`型の定義
- `getSecretKey`の実装
- `getConditionHash`の実装
- _要件: 要件6_

#### - [ ] 2.7.2 Witness関数のテスト
- Witness関数が正しく呼び出されることを確認
- プライベート状態が正しく渡されることを確認
- _要件: 要件6_

### - [ ] 2.8 コントラクトのコンパイルとビルド

#### - [ ] 2.8.1 Compactコンパイル
- `pnpm compact`でコンパイル
- エラーがないことを確認
- `managed/nextmed`ディレクトリの生成確認
- _要件: 要件9_

#### - [ ] 2.8.2 TypeScriptビルド
- `pnpm build`でビルド
- 型エラーがないことを確認
- _要件: 要件9_

### - [ ] 2.9 統合テストの実行

#### - [ ] 2.9.1 全テストの実行
- `pnpm test`で全テストを実行
- すべてのテストが通ることを確認
- テストカバレッジの確認（目標: 回路100%、分岐90%以上）
- _要件: すべて_

---

## - [ ] 3. CLIツールの実装（TDD）

### - [ ] 3.1 CLIプロジェクトのセットアップ
- `pkgs/cli`ディレクトリの確認
- 依存関係の確認（Midnight SDK、contract パッケージ）
- Vitestテスト環境のセットアップ
- _要件: 要件9_

### - [ ] 3.2 コントラクトデプロイ機能の実装（TDD）

#### - [ ] 3.2.1 デプロイ機能のテストを追加（Red）
- スタンドアロン環境でのデプロイテスト
- デプロイ後のコントラクトアドレス取得テスト
- テストを実行して失敗することを確認
- _要件: 要件9_

#### - [ ] 3.2.2 デプロイ機能の実装（Green）
- `scripts/deploy.ts`の作成
- `deployContract`関数の実装
- すべてのテストが通ることを確認
- _要件: 要件9_

#### - [ ] 3.2.3 リファクタリング（Refactor）
- デプロイロジックの最適化
- エラーハンドリングの改善
- _要件: 要件9_

### - [ ] 3.3 患者データ登録機能の実装（TDD）

#### - [ ] 3.3.1 患者データ登録のテストを追加（Red）
- 患者データ登録のAPIテスト
- トランザクション送信のテスト
- 患者ID取得のテスト
- テストを実行して失敗することを確認
- _要件: 要件1_

#### - [ ] 3.3.2 患者データ登録機能の実装（Green）
- `registerPatient`関数の実装
- ウォレット統合
- すべてのテストが通ることを確認
- _要件: 要件1_

#### - [ ] 3.3.3 リファクタリング（Refactor）
- 登録ロジックの最適化
- _要件: 要件1_

### - [ ] 3.4 同意管理機能の実装（TDD）

#### - [ ] 3.4.1 同意管理のテストを追加（Red）
- 同意付与のAPIテスト
- 同意取り消しのAPIテスト
- 同意確認のAPIテスト
- テストを実行して失敗することを確認
- _要件: 要件2_

#### - [ ] 3.4.2 同意管理機能の実装（Green）
- `grantConsent`関数の実装
- `revokeConsent`関数の実装
- `checkConsent`関数の実装
- すべてのテストが通ることを確認
- _要件: 要件2_

#### - [ ] 3.4.3 リファクタリング（Refactor）
- 同意管理ロジックの最適化
- _要件: 要件2_

### - [ ] 3.5 データクエリ機能の実装（TDD）

#### - [ ] 3.5.1 データクエリのテストを追加（Red）
- 患者データ取得のAPIテスト
- クエリ記録のAPIテスト
- テストを実行して失敗することを確認
- _要件: 要件3_

#### - [ ] 3.5.2 データクエリ機能の実装（Green）
- `getPatientData`関数の実装
- `recordQuery`関数の実装
- すべてのテストが通ることを確認
- _要件: 要件3_

#### - [ ] 3.5.3 リファクタリング（Refactor）
- クエリロジックの最適化
- _要件: 要件3_

### - [ ] 3.6 統合テストの実行

#### - [ ] 3.6.1 スタンドアロン環境でのテスト
- `pnpm test-api`で統合テストを実行
- すべてのテストが通ることを確認
- _要件: すべて_

---

## - [ ] 4. フロントエンドの実装（TDD）

### - [ ] 4.1 Next.jsプロジェクトのセットアップ
- `pkgs/frontend`ディレクトリの確認
- 依存関係の確認（Next.js 16.0.0、React 19.2.0）
- Tailwind CSS、shadcn/uiの設定確認
- Vitest + React Testing Libraryのセットアップ
- _要件: 要件5, 要件7, 要件8_

### - [ ] 4.2 ウォレット統合（TDD）

#### - [ ] 4.2.1 ウォレット接続のテストを追加（Red）
- ウォレット接続ボタンのクリックテスト
- ウォレットアドレス表示テスト
- ウォレット切断テスト
- エラーハンドリングテスト
- テストを実行して失敗することを確認
- _要件: 要件5_

#### - [ ] 4.2.2 ウォレット接続機能の実装（Green）
- Lace Wallet DApp Connectorの統合
- ウォレット接続コンポーネントの作成
- ウォレット状態管理（Context API）
- すべてのテストが通ることを確認
- _要件: 要件5_

#### - [ ] 4.2.3 リファクタリング（Refactor）
- ウォレット状態管理の最適化
- エラーハンドリングの改善
- _要件: 要件5_

### - [ ] 4.3 ランディングページとログイン画面（TDD）

#### - [ ] 4.3.1 ランディングページのテストを追加（Red）
- ヒーローセクションの表示テスト
- ログインボタンのクリックテスト
- テストを実行して失敗することを確認
- _要件: 要件5_

#### - [ ] 4.3.2 ランディングページの実装（Green）
- ランディングページの作成
- ログイン画面の作成
- すべてのテストが通ることを確認
- _要件: 要件5_

#### - [ ] 4.3.3 リファクタリング（Refactor）
- レイアウトの最適化
- _要件: 要件5_

### - [ ] 4.4 患者データ登録フォーム（TDD）

#### - [ ] 4.4.1 患者データ登録フォームのテストを追加（Red）
- フォーム入力のバリデーションテスト
- 送信ボタンのクリックテスト
- 成功メッセージの表示テスト
- エラーハンドリングのテスト
- テストを実行して失敗することを確認
- _要件: 要件1_

#### - [ ] 4.4.2 患者データ登録フォームの実装（Green）
- 年齢入力フィールド
- 性別選択ドロップダウン
- 症例入力フィールド
- フォームバリデーション
- 送信処理とトランザクション署名
- すべてのテストが通ることを確認
- _要件: 要件1_

#### - [ ] 4.4.3 リファクタリング（Refactor）
- フォームロジックの最適化
- バリデーションの改善
- _要件: 要件1_

### - [ ] 4.5 同意管理UI（TDD）

#### - [ ] 4.5.1 同意管理UIのテストを追加（Red）
- 同意付与ボタンのクリックテスト
- 同意取り消しボタンのクリックテスト
- 同意状態の表示テスト
- エラーハンドリングのテスト
- テストを実行して失敗することを確認
- _要件: 要件2_

#### - [ ] 4.5.2 同意管理UIの実装（Green）
- 同意付与ボタンの実装
- 同意取り消しボタンの実装
- 同意状態の表示
- トランザクション署名処理
- すべてのテストが通ることを確認
- _要件: 要件2_

#### - [ ] 4.5.3 リファクタリング（Refactor）
- 同意管理UIの最適化
- ユーザビリティの改善
- _要件: 要件2_

### - [ ] 4.6 患者データ表示（TDD）

#### - [ ] 4.6.1 患者データ表示のテストを追加（Red）
- データ取得のテスト
- データ表示のテスト
- ローディング状態のテスト
- エラー状態のテスト
- テストを実行して失敗することを確認
- _要件: 要件1, 要件3_

#### - [ ] 4.6.2 患者データ表示の実装（Green）
- データ取得ロジックの実装
- データ表示コンポーネントの実装
- ローディング状態の実装
- エラー状態の実装
- すべてのテストが通ることを確認
- _要件: 要件1, 要件3_

#### - [ ] 4.6.3 リファクタリング（Refactor）
- データ表示ロジックの最適化
- パフォーマンスの改善
- _要件: 要件1, 要件3_

### - [ ] 4.7 監査ログ表示（TDD）

#### - [ ] 4.7.1 監査ログ表示のテストを追加（Red）
- ログ取得のテスト
- ログ表示のテスト
- フィルタリング機能のテスト
- ページネーション機能のテスト
- テストを実行して失敗することを確認
- _要件: 要件2_

#### - [ ] 4.7.2 監査ログ表示の実装（Green）
- ログ取得ロジックの実装
- ログ表示コンポーネントの実装
- フィルタリング機能の実装
- ページネーション機能の実装
- すべてのテストが通ることを確認
- _要件: 要件2_

#### - [ ] 4.7.3 リファクタリング（Refactor）
- ログ表示ロジックの最適化
- UIの改善
- _要件: 要件2_

### - [ ] 4.8 ダークモード対応（TDD）

#### - [ ] 4.8.1 ダークモードのテストを追加（Red）
- テーマ切り替えボタンのテスト
- テーマ状態の永続化テスト
- テストを実行して失敗することを確認
- _要件: 要件7_

#### - [ ] 4.8.2 ダークモードの実装（Green）
- next-themesの統合
- テーマ切り替えボタンの実装
- すべてのテストが通ることを確認
- _要件: 要件7_

#### - [ ] 4.8.3 リファクタリング（Refactor）
- テーマ管理の最適化
- _要件: 要件7_

### - [ ] 4.9 レスポンシブデザインの実装（TDD）

#### - [ ] 4.9.1 レスポンシブデザインのテストを追加（Red）
- モバイル表示のテスト
- タブレット表示のテスト
- デスクトップ表示のテスト
- テストを実行して失敗することを確認
- _要件: 要件7_

#### - [ ] 4.9.2 レスポンシブデザインの実装（Green）
- Tailwind CSSのブレークポイントを使用
- モバイルファーストのレイアウト実装
- すべてのテストが通ることを確認
- _要件: 要件7_

#### - [ ] 4.9.3 リファクタリング（Refactor）
- レイアウトの最適化
- _要件: 要件7_

### - [ ] 4.10 アクセシビリティ対応（TDD）

#### - [ ] 4.10.1 アクセシビリティのテストを追加（Red）
- キーボードナビゲーションのテスト
- スクリーンリーダー対応のテスト
- ARIA属性のテスト
- テストを実行して失敗することを確認
- _要件: 要件7_

#### - [ ] 4.10.2 アクセシビリティの実装（Green）
- ARIA属性の追加
- キーボードナビゲーションの実装
- フォーカス管理の実装
- すべてのテストが通ることを確認
- _要件: 要件7_

#### - [ ] 4.10.3 リファクタリング（Refactor）
- アクセシビリティの最適化
- _要件: 要件7_

---

## - [ ] 5. バックエンドAPIの実装（TDD）

### - [ ] 5.1 バックエンドプロジェクトのセットアップ
- `pkgs/backend`ディレクトリの作成
- Express.jsのセットアップ
- TypeScriptの設定
- Vitestテスト環境のセットアップ
- _要件: 要件8_

### - [ ] 5.2 コントラクト状態取得API（TDD）

#### - [ ] 5.2.1 状態取得APIのテストを追加（Red）
- エンドポイントのテスト
- レスポンス形式のテスト
- エラーハンドリングのテスト
- テストを実行して失敗することを確認
- _要件: 要件8_

#### - [ ] 5.2.2 状態取得APIの実装（Green）
- `/api/contract/state`エンドポイントの実装
- Midnight Indexerとの統合
- すべてのテストが通ることを確認
- _要件: 要件8_

#### - [ ] 5.2.3 リファクタリング（Refactor）
- APIロジックの最適化
- エラーハンドリングの改善
- _要件: 要件8_

### - [ ] 5.3 患者データ取得API（TDD）

#### - [ ] 5.3.1 患者データ取得APIのテストを追加（Red）
- エンドポイントのテスト
- 認証のテスト
- レスポンス形式のテスト
- エラーハンドリングのテスト
- テストを実行して失敗することを確認
- _要件: 要件1, 要件8_

#### - [ ] 5.3.2 患者データ取得APIの実装（Green）
- `/api/patients/:id`エンドポイントの実装
- コントラクトとの統合
- すべてのテストが通ることを確認
- _要件: 要件1, 要件8_

#### - [ ] 5.3.3 リファクタリング（Refactor）
- APIロジックの最適化
- _要件: 要件1, 要件8_

### - [ ] 5.4 同意状態取得API（TDD）

#### - [ ] 5.4.1 同意状態取得APIのテストを追加（Red）
- エンドポイントのテスト
- 認証のテスト
- レスポンス形式のテスト
- エラーハンドリングのテスト
- テストを実行して失敗することを確認
- _要件: 要件2, 要件8_

#### - [ ] 5.4.2 同意状態取得APIの実装（Green）
- `/api/consents/:patientId/:researcherId`エンドポイントの実装
- コントラクトとの統合
- すべてのテストが通ることを確認
- _要件: 要件2, 要件8_

#### - [ ] 5.4.3 リファクタリング（Refactor）
- APIロジックの最適化
- _要件: 要件2, 要件8_

### - [ ] 5.5 監査ログ取得API（TDD）

#### - [ ] 5.5.1 監査ログ取得APIのテストを追加（Red）
- エンドポイントのテスト
- 認証のテスト
- フィルタリング機能のテスト
- ページネーション機能のテスト
- レスポンス形式のテスト
- エラーハンドリングのテスト
- テストを実行して失敗することを確認
- _要件: 要件2, 要件8_

#### - [ ] 5.5.2 監査ログ取得APIの実装（Green）
- `/api/audit-logs`エンドポイントの実装
- Midnight Indexerとの統合
- フィルタリング機能の実装
- ページネーション機能の実装
- すべてのテストが通ることを確認
- _要件: 要件2, 要件8_

#### - [ ] 5.5.3 リファクタリング（Refactor）
- APIロジックの最適化
- パフォーマンスの改善
- _要件: 要件2, 要件8_

### - [ ] 5.6 統合テストの実行

#### - [ ] 5.6.1 全APIエンドポイントのテスト
- すべてのエンドポイントの統合テストを実行
- すべてのテストが通ることを確認
- _要件: 要件8_

---

## - [ ] 6. エンドツーエンドテスト（TDD）

### - [ ] 6.1 E2Eテスト環境のセットアップ
- Playwrightのインストール
- テスト設定ファイルの作成
- _要件: すべて_

### - [ ] 6.2 患者データ登録フローのE2Eテスト（Red → Green → Refactor）

#### - [ ] 6.2.1 E2Eテストを追加（Red）
- ウォレット接続のテスト
- フォーム入力のテスト
- トランザクション署名のテスト
- 成功メッセージの確認テスト
- テストを実行して失敗することを確認
- _要件: 要件1, 要件5_

#### - [ ] 6.2.2 必要な修正を実施（Green）
- テストが通るように実装を修正
- すべてのテストが通ることを確認
- _要件: 要件1, 要件5_

#### - [ ] 6.2.3 リファクタリング（Refactor）
- テストコードの最適化
- _要件: 要件1, 要件5_

### - [ ] 6.3 同意管理フローのE2Eテスト（Red → Green → Refactor）

#### - [ ] 6.3.1 E2Eテストを追加（Red）
- 同意付与のテスト
- 同意取り消しのテスト
- 同意状態確認のテスト
- テストを実行して失敗することを確認
- _要件: 要件2_

#### - [ ] 6.3.2 必要な修正を実施（Green）
- テストが通るように実装を修正
- すべてのテストが通ることを確認
- _要件: 要件2_

#### - [ ] 6.3.3 リファクタリング（Refactor）
- テストコードの最適化
- _要件: 要件2_

### - [ ] 6.4 データクエリフローのE2Eテスト（Red → Green → Refactor）

#### - [ ] 6.4.1 E2Eテストを追加（Red）
- データ取得のテスト
- クエリ記録のテスト
- 監査ログ確認のテスト
- テストを実行して失敗することを確認
- _要件: 要件3_

#### - [ ] 6.4.2 必要な修正を実施（Green）
- テストが通るように実装を修正
- すべてのテストが通ることを確認
- _要件: 要件3_

#### - [ ] 6.4.3 リファクタリング（Refactor）
- テストコードの最適化
- _要件: 要件3_

---

## - [ ] 7. デプロイとドキュメント

### - [ ] 7.1 Testnet-02へのデプロイ
- コントラクトのTestnet-02へのデプロイ
- デプロイ後の動作確認
- _要件: 要件9_

### - [ ] 7.2 フロントエンドのデプロイ
- Vercelへのデプロイ設定
- 環境変数の設定
- デプロイ後の動作確認
- _要件: 要件7_

### - [ ] 7.3 バックエンドのデプロイ
- バックエンドAPIのデプロイ
- 環境変数の設定
- デプロイ後の動作確認
- _要件: 要件8_

### - [ ] 7.4 ドキュメントの作成
- README.mdの更新
- セットアップガイドの作成
- API仕様書の作成
- ユーザーガイドの作成
- _要件: すべて_

### - [ ] 7.5 セキュリティ監査
- 依存関係の脆弱性チェック
- コードの静的解析
- セキュリティベストプラクティスの確認
- _要件: 要件4_

---

## 完了条件

すべてのタスクが完了し、以下の条件を満たすこと：

1. すべてのユニットテストが通過（カバレッジ: 回路100%、分岐90%以上）
2. すべての統合テストが通過
3. すべてのE2Eテストが通過
4. Testnet-02での動作確認完了
5. ドキュメントが完成
6. セキュリティ監査完了

---

## 注意事項

- **TDDの厳守**: すべてのタスクで**Red → Green → Refactor**のサイクルを守る
- **テストファースト**: 実装前に必ずテストを書く
- **小さなステップ**: 一度に多くを実装せず、小さなステップで進める
- **継続的なリファクタリング**: 動作するコードを書いた後、必ずリファクタリングする
- **テストの品質**: テストは実装詳細ではなく振る舞いをテストする
- **Compact言語の制約**: Compact言語の制約を常に意識し、実装可能な範囲で設計する
- **プライバシー保護**: 患者データのプライバシーを最優先に考慮する
- **エラーハンドリング**: すべてのエラーケースを適切に処理する
- **ドキュメント**: コードと同時にドキュメントを更新する
